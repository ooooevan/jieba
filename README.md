## å­¦ä¹ jiebaåˆ†è¯

å‚è€ƒï¼š[https://github.com/ustcdane/annotated_jieba](https://github.com/ustcdane/annotated_jieba)

```js
const Jieba = require('ooooevan-jieba')
const jieba = new Jieba()
const result = jieba.cut("ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼ŒğŸ™‹ æˆ‘ä»¬å»éƒŠæ¸¸ã€‚",{
    cutAll: false,
    dag: false,
    hmm: true,
    cutForSearch: false
  })
// ['ä»Šå¤©å¤©æ°”', 'å¾ˆ', 'å¥½', 'ï¼Œ', 'ğŸ™‹', ' ', 'æˆ‘ä»¬', 'å»', 'éƒŠæ¸¸', 'ã€‚']
```

å®ç°äº†cutã€cutHMMã€cutAllã€cutForSearchã€getDagã€tagã€loadæ–¹æ³•


### è¿‡ç¨‹ä¸­çš„é—®é¢˜

### 1ã€æŒ‰ç…§æ€è·¯å†™ï¼ŒåŒæ ·çš„è¯åº“ï¼Œè‡ªå·±çš„cut(str, true)å’Œhmmæ–¹æ³•ä¸å®˜æ–¹(pythonç‰ˆæˆ–nodejiebaç‰ˆ)çš„ç»“æœä¸ä¸€è‡´

å¦‚: 
```js
str = 'åˆ°MIäº¬ç ”å¤§å¦'
// nodejiebaçš„ç»“æœ
nodejieba.cut(str); // ['åˆ°', 'M', 'I', 'äº¬', 'ç ”', 'å¤§å¦']
nodejieba.cut(str, true); // ['åˆ°', 'MI', 'äº¬ç ”', 'å¤§å¦']
nodejieba.cutHMM(str);  // [ 'åˆ°', 'MI', 'äº¬', 'ç ”å¤§å¦' ]
// è‡ªå·±çš„ç»“æœ
cut(str, true);   // [ 'åˆ°M', 'Iäº¬', 'ç ”', 'å¤§å¦' ]
hmm(str);  // ['åˆ°M', 'Iäº¬', 'ç ”å¤§', 'å¦']
```

é€šè¿‡è°ƒè¯•çœ‹æºç ï¼Œå‘ç°äº†hmmç”¨åˆ°äº†å¾ˆå¤šçš„æ­£åˆ™åŒ¹é…ã€‚
```js
const re_userdict = /^(.+?)( [0-9]+)?( [a-z]+)?$/
const re_eng = /[a-zA-Z0-9]/
const re_han_default = /([\u4E00-\u9FD5a-zA-Z0-9+#&\._%]+)/
const re_skip_default = /(\r\n|\s)/
const re_han_cut_all = /([\u4E00-\u9FD5]+)/
const re_skip_cut_all = /[^a-zA-Z0-9+#\n]/

const han_reg = /([\u4E00-\u9FD5]+)/;
const seg_reg = /([a-zA-Z0-9]+(?:\.\d)?)|([0-9]+(?:\.\d)?%?)/;
```
å¤§è‡´ç­–ç•¥æ˜¯å…ˆå°†ä¸­æ–‡å’Œéä¸­æ–‡åˆ†å¼€ï¼Œå¯¹äºéä¸­æ–‡ï¼Œå†åŒºåˆ†æ™®é€šçš„è‹±æ–‡æ•°å­—å’Œå…¶ä»–ç‰¹æ®Šå­—ç¬¦<br>
ä½¿ç”¨äº†ä¸€äº›æ­£åˆ™ï¼Œå°±èƒ½å¾—åˆ°ä¸€è‡´çš„ç»“æœ


#### 2ã€hmmå‡½æ•°æ„å»ºæ ¹æ®BEMSæ„å»ºæ ‘æœªä¼˜åŒ–ï¼Œè€—æ—¶ä¸”å¤ªé•¿ä¼šå¯¼è‡´å†…å­˜ä¸è¶³

åœ¨ä¹‹å‰ï¼Œæˆ‘å°†ç”¨æˆ·è¾“å…¥æ„å»ºæ„å»ºæˆæ ‘æ—¶éå¸¸ç¹çå¤æ‚ï¼Œæµªè´¹å¾ˆå¤šå†…å­˜ï¼Œå®¹æ˜“é€ æˆå†…å­˜ä¸è¶³

```js
// ä¹‹å‰çš„æ–¹æ³•
var str = "æˆ‘æ˜¯æ‹–æ‹‰æœºå­¦é™¢æ‰‹æ‰¶æ‹–æ‹‰æœºä¸“ä¸šçš„ã€‚ä¸ç”¨å¤šä¹…ï¼Œæˆ‘å°±ä¼šå‡èŒåŠ è–ªï¼Œå½“ä¸ŠCEOï¼Œèµ°ä¸Šäººç”Ÿå·…å³°ã€‚";
const treeObj = getWordTree(str); //å°†å­—ç¬¦ä¸²è½¬ä¸ºä¸€ä¸ªå¤§å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«éœ€è¦çš„å­—ç¬¦èŠ‚ç‚¹ç›¸å…³æ•°æ®
var treeArr = recursion(treeObj);  //å°†å¤§å¯¹è±¡è½¬ä¸ºåŒç­‰çš„äºŒç»´æ•°ç»„ï¼Œé‡Œé¢æœ‰2**nä¸ªæ•°ç»„ï¼Œä¹Ÿå°±æ˜¯2**nä¸ªä¸åŒè·¯å¾„
var conarr = getAppropriate(treeArr); //ä»2**nä¸ªæ•°ç»„ä¸­é€‰å‡ºæœ€ä¼˜çš„ä¸€ä¸ªæ•°ç»„
```

è¿™ç§æ–¹æ³•å¾ˆç›´ç™½ï¼Œæ˜¯æˆ‘æ ¹æ®hmmç®—æ³•æè¿°å†™çš„ï¼Œæœ‰å¤ªå¤šä¸éœ€è¦çš„æ•°æ®ï¼Œå¯¼è‡´å†…å­˜å¯èƒ½çˆ†æ‰ã€‚æ˜¯`2**n`ä¸ªè€Œä¸æ˜¯`4**n`ï¼Œå› ä¸ºæ¯ä¸ªå­—ç¬¦åœ¨æ‰€åœ¨ä½ç½®éƒ½åªæœ‰ä¸¤ç§ç±»å‹è€Œä¸æ˜¯å››ç§ã€‚å¦‚å¼€å¤´å­—ç¬¦åªå¯èƒ½æ˜¯Bæˆ–Sï¼Œä¸èƒ½æ˜¯Eæˆ–Mã€‚

```js
str = 'ç¨‹åºå‘˜'
treeObj = {
  b:{
    next:{
      e:{
        next:{...}
      },
      m:{
        next:{...}
      }
    },
    value: -7.5608
  },
  s:{
    next:{
      s:{
        next:{...}
      },
      b:{
        next:{...}
      }
    },
    value: -11.0326
  }
}
treeArr = [ //é•¿åº¦æ˜¯8
  [{type:B,value:-7.5608},{type:E,value:-8.363},{type:B,value:-9.5638}],
  []
  ...
]
conarr = [ //æœ€ä¼˜è·¯å¾„
  {type: "B", value: -7.5608126080925, string: "ç¨‹"},
  {type: "M", value: -9.818418731874154, string: "åº"},
  {type: "E", value: -6.2620785681194855, string: "å‘˜"}
]

```
å¯¼è‡´å†…å­˜ä¸è¶³åï¼Œä¿®æ”¹ä¸ºå®˜æ–¹çš„æ–¹å¼ï¼Œæ€è·¯å¦‚ä¸‹å°

```js
str = 'ç¨‹åºå‘˜'
const prevTrans = {   //ä¸Šä¸€ä¸ªçŠ¶æ€å¯èƒ½ç±»å‹
  B: [E, S],
  E: [B, M],
  M: [B, M],
  S: [E, S]
}
// é€šè¿‡åŠ¨æ€è§„åˆ’è®¡ç®—ä¸‹é¢ç»“æœ
"'ç¨‹'çš„æ¦‚ç‡" = {B:'', E:'', M:'', S:''}
"'åº'çš„æ¦‚ç‡" = {B:'', E:'', M:'', S:''}
"'å‘˜'çš„æ¦‚ç‡" = {B:'', E:'', M:'', S:''}
/*
å¼€å¤´å­—ç¬¦æ¦‚ç‡æ˜¯ç¡®å®šçš„ï¼Œåä¸€ä¸ªè¦æ ¹æ®å‰ä¸€ä¸ªæ¥ç¡®å®šã€‚å¦‚'åº'(æœ‰BEMS)ä¸­çš„Bï¼Œå’Œå‰ä¸€ä¸ªä¸€èµ·çš„å¯èƒ½ç±»å‹ç»„åˆæ˜¯ï¼šEBæˆ–SBï¼Œåˆ™é€‰æ‹©è®¡ç®—ä¸¤ç§çš„è¾ƒé«˜æ¦‚ç‡çš„ä¸€ç§ã€‚
æ‰€ä»¥æ¦‚ç‡è¡¨ä¿å­˜çš„æ˜¯ç»„åˆçš„æ¦‚ç‡ï¼Œæ¯ä¸ªå­—ç¬¦çš„æ¦‚ç‡éƒ½åŸºäºå‰nä¸ªå­—ç¬¦çš„æ¦‚ç‡ã€‚è¿™é‡Œå’Œcutå‡½æ•°æœ€å¤§åˆ‡åˆ†ç»„åˆç±»ä¼¼ï¼Œåªæ˜¯é‚£é‡Œæ˜¯ä»åå¾€å‰ï¼Œè¿™é‡Œæ˜¯ä»å‰å¾€åçš„*/
/*
"'ç¨‹'çš„æ¦‚ç‡" = {B:'', E:'', M:'', S:''} //ä¿å­˜å­—ç¬¦'ç¨‹'çš„ä¸åŒç±»å‹çš„æ¦‚ç‡
"'åº'çš„æ¦‚ç‡" = {B:'', E:'', M:'', S:''} //ä¿å­˜å­—ç¬¦'ç¨‹åº'çš„ä¸åŒç±»å‹çš„æ¦‚ç‡
"'å‘˜'çš„æ¦‚ç‡" = {B:'', E:'', M:'', S:''} //ä¿å­˜å­—ç¬¦'ç¨‹åºå‘˜'çš„ä¸åŒç±»å‹çš„æ¦‚ç‡
*/

// æ¦‚ç‡å¯ä»¥ç¡®å®šäº†ï¼Œåªè¦åœ¨è®¡ç®—æ¦‚ç‡æ—¶ï¼ŒåŒæ—¶ä¿å­˜è·¯å¾„
// æ ¹æ®æœ€åå¾—åˆ°çš„æœ€å¤§æ¦‚ç‡ç±»å‹ï¼Œå°±å¯ä»¥å¾—å‡ºæ˜¯å“ªä¸ªè·¯å¾„äº†
path = {B: "BEB", E: "BME", M: "BMM", S: "BES"}

```

æ”¹æˆå®˜æ–¹çš„æ–¹å¼ï¼Œæœç„¶å¥½å¤šäº†ï¼Œå†ä¹Ÿä¸æ€•ç”¨å¤ªå¤šå†…å­˜äº†

#### 3ã€ä¸ç”¨Trieï¼Œæ”¹ç”¨æ•°ç»„

https://blog.csdn.net/daniel_ustc/article/details/48223135

ç”¨process.memoryUsageæµ‹è¯•ç”¨æ‰çš„å †å’Œæ—¶é—´

å­—å…¸ç»“æ„å¦‚ä¸‹ï¼š
```js
str = 'åŒ—äº¬å¤§å­¦'
// trieç»“æ„å®ç°
{
  'åŒ—':{
    number: '',
    tag:'',
    bound: true,
    chilren:{
      'äº¬':{...}
    }
  },
}
// æ•°ç»„å®ç°
[
'åŒ—': {number:17860,tag:'ns'},
'åŒ—äº¬': {number:34488,tag:'ns'},
'åŒ—äº¬å¤§': 0,
'åŒ—äº¬å¤§å­¦': {number:2053,tag:'nt'}
...
]
```

æµ‹è¯•æ€§èƒ½ï¼š
```js
var one = process.memoryUsage()
var start = new Date()

var sentence = "æˆ‘æ˜¯æ‹–æ‹‰æœºå­¦é™¢æ‰‹æ‰¶æ‹–æ‹‰æœºä¸“ä¸šçš„ã€‚ä¸ç”¨å¤šä¹…ï¼Œæˆ‘å°±ä¼šå‡èŒåŠ è–ªï¼Œå½“ä¸ŠCEOï¼Œèµ°ä¸Šäººç”Ÿå·…å³°ã€‚";
const myjieba = new Cut()
const res = myjieba.cut(sentence);

var two = process.memoryUsage()
var usage = two.heapUsed - one.heapUsed
console.log(usage)
console.log(new Date() - start)
```

| æ—¶é—´   | Trieç»“æ„     | æ•°ç»„         |
| ------ | ------------ | ------------ |
| win10  | (127M, 1.1s) | (110M, 1s)   |
| Ubuntu | (117M, 1.5s) | (108M, 1.3s) |

åˆ†åˆ«ç”¨æˆ‘çš„win10å’Œè™šæ‹Ÿæœºæµ‹è¯•ï¼Œå…¶ä¸­çš„å­—å…¸éƒ½æ˜¯`nodejieba`é‡Œé¢çš„ï¼Œç”¨åˆ°äº†`jieba.dict.utf8`ã€`hmm_model.utf8`å’Œ`user.txt`ï¼Œè¿™é‡Œåªè¡¨ç°ç›¸å¯¹æƒ…å†µã€‚<br>
ç»“æœå¯è§ï¼Œç”¨æ•°ç»„æ€»ä½“æ¯”ç”¨Trieç»“æ„å¥½ä¸€ç‚¹<br>


### Trieåº”ç”¨åœºæ™¯

[https://www.cnblogs.com/justinh/p/7716421.html](https://www.cnblogs.com/justinh/p/7716421.html)<br>
æ–‡æœ¬é¢„æµ‹ï¼ˆä»£ç æç¤ºï¼‰ï¼šå‰ç¼€ä¸€è‡´ï¼Œåé¢çš„éƒ½æ˜¯å¯èƒ½å‡ºç°çš„ç»“æœ
